---
title: "Supplement"
author: "Joe Hilgard"
date: "March 25, 2016"
output: word_document
---

<!--- This is a chore because broom::tidy doesn't work on censReg objects, so I can't use hilgard::report_t() --->

###Censored regression. 
To attempt to ameliorate the potential ceiling effect, a censored regression model was fit with the ‘censReg’ package for R (Henningsen, 2013). This fits a censored-regression Tobit model and attempts to model values that exceed the maximum of the scale.

```{r, echo = F, warning = F, include = F}
library(hilgard)
library(broom)
library(tidyverse)
load(".Rdata")

# This will take a little work because tidy::broom() won't play with censReg
tidyCensReg <- function(x) {
  print(summary(x)) # including this somehow fixes the bug
  # get table of estimates
  step1 <- summary(x)
  bar <- step1$estimate
  # tidy and give nice names
  out <- broom::tidy(bar)
  names(out) <- c("term", "estimate", "std.error", "statistic", "p.value")
  # round variables for readability
  out <- mutate_at(out, .vars = vars(estimate:p.value), .funs = funs(round(., 3)))
  # return output
  return(out)
}

report_t_censReg <- function(model, effect, metric = "b", n1, n2) {
  frame <- tidyCensReg(x = model)
  t <- with(frame, statistic[term == effect])
  t <- round(t, 2)
  df <- model$df.residual
  p <- with(frame, p.value[term == effect])
  p <- fix_p(p)
  if (metric == "b") {
    b <- with(frame, estimate[term == effect])
    b <- numformat(b)
    ci <- confint(model)
    ci <- broom::tidy(ci)
    ci <- dplyr::filter(ci, .rownames == effect)
    ci <- dplyr::select(ci, -c(.rownames))
    ci <- numformat(ci)
    esci.out <- paste0("*b* = ", b, " [", ci[1], ", ", ci[2], 
                       "]")
  }
  if (metric == "d") {
    esci <- with(frame, statistic[term == effect]) %>% compute.es::tes(n1, 
                                                                       n2, verbose = F)
    esci.out <- paste0("*d* = ", esci$d, " [", esci$l.d, 
                       ", ", esci$u.d, "]")
  }
  if (metric == "r") {
    esci <- with(frame, statistic[term == effect]) %>% compute.es::tes(n1, 
                                                                       n2, verbose = F)
    if (with(frame, statistic[term == effect]) >= 0) {
      esci.out <- paste0("*r* = ", numformat(esci$r), " [", 
                         numformat(esci$l.r), ", ", numformat(esci$u.r), 
                         "]")
    }
    if (with(frame, statistic[term == effect]) < 0) {
      esci.out <- paste0("*r* = ", numformat(-esci$r), 
                         " [", numformat(-esci$u.r), ", ", numformat(-esci$l.r), 
                         "]")
    }
  }
  t.out <- paste0("*t*(", df, ") = ", t, ", ", p)
  output <- paste0(t.out, ", ", esci.out)
  return(output)
}
  
# Maybe easiest just to report as a series of supplementary tables
# tidyCensReg(censModel1) # Left hand
# tidyCensReg(censModel1.1) # Left hand with covar
# tidyCensReg(censModel2) # right hand
# tidyCensReg(censModel2.1) # right hand with covar
```

Application of this analysis to 2 Violence × 2 Difficulty ANOVA found no significant effects of violence (`r report_t_censReg(censModel3, "vioContr", "r", 275/2, 275/2)`), difficulty (`r report_t_censReg(censModel3, "diffContr", "r", 275/2, 275/2)`), or their interaction (`r report_t_censReg(censModel3, "diffContr:vioContr", "r", 275/2, 275/2)`). A significant effect of irritation with the partner's feedback was observed, but applying this as a covariate did not affect the primary results.

Main effects of 2D:4D on aggression were again negligible. Left 2D:4D did not predict aggression, `r report_t_censReg(censModel1, "L2d4d_std")`, nor did right 2D:4D, `r report_t_censReg(censModel2, "R2d4d_std")`. Application of composite irritation as a covariate did not influence the estimated effect. Higher-order interactions of 2D:4D with factors of Violence or Difficulty were not supported by the results (all |*t*| < 1), with the exception of a Difficulty × Violence × Right 2D:4D interaction that was barely significant after adjusting for irritation (*p* = .044).

###Logistic regression. 
Another possibility is that participants completed the coldpressor assignment in one of two ways: either they followed instructions and randomly assigned the other participant to a value between 1 and 9, or they decided to aggress and assign the other participant the maximum value. To model this possibility, I treated the response variable as a dichotomous outcome. Participants assigning values 1-8 were treated as one category (nonaggressive response) and participants assigning value 9 were treated as the other (aggressive response). Logistic regression was performed to test whether the odds of aggressing were influenced by the experimental assignment.

We conducted a 2 Violence × 2 Difficulty ANOVA with a logistic link function. Violence did not appear to influence aggression, `r report_z(model3, "vioContr")`. Difficulty also had a minimal effect on aggression, `r report_z(model3, "diffContr")`.	Application of composite irritation as a covariate to these models revealed an effect of composite irritation, `r report_z(model3.5, "feedback.NA")`, but did not increase the estimated effects of violence, difficulty, or their interaction.

Main effects of 2D:4D on aggression were again negligible. Left 2D:4D did not predict aggression, `r report_z(model1, "L2d4d_std")`, nor did right 2D:4D, `r report_z(model2, "R2d4d_std")`. Application of composite irritation as a covariate did not influence the estimated effect. Higher-order interactions of 2D:4D with factors of Violence or Difficulty were not supported by the results (all |*t*| < 1.53).

###Ordinal regression.
<!--- May benefit from more detail, or just some tables --->
The outcome could also be treated as an ordinal value. We used ordinal logistic regression via the "ordinal" package for R (Christensen, 2018) to fit the 2 Violence × 2 Difficulty ANOVA. No significant effects were observed. Addition of left or right 2d4d ratio to these models revealed no significant effects.

Applying composite irritation as a covariate generally did not affect the results. As with the censored regression approach above, the Violence × Difficulty × Right 2D:4D interaction just reached significance after application of the covariate (*p* = .019).

```{r, echo = F}

```


###Exploratory analyses.
The 6 items about the interaction with the partner were submitted to parallel analysis. Parallel analysis recommended two factors. Factor 1 had loadings >.65 on irritated, angered, and annoyed, with loadings < .3 otherwise. Factor 2 had loadings .57, .61, and .89 for happy, helpful, and pleased.

The 18 items about the gameplay session were submitted to parallel analysis. Parallel analysis recommended four factors. Loadings are displayed in [TABLE X]. Loadings smaller than .1 are not displayed.  The first factor appears to represent excitement and enjoyment of the game. The second factor appears to represent the extent to which the game was stressful. The third factor appears to represent whether the participant struggled with the game's controls and navigation. The fourth factor featured items indicating whether the player perceived the game as involving violence and gore, but it also featured loadings regarding whether the player's guns/zorchers were satisfying and effective.

```{r echo=F, warning = F}
round(efa2$loadings, 2)
```

Participants' gameplay variables were submitted to parallel analysis. However, factor extraction resulted in Heywood cases. Each was analyzed singly as a potential predictor of aggressive behavior. Players with more kills/zorches gave lower coldpressor assignments (p = .013). Players firing more total combined bullets and shotgun shells also gave lower coldpressor assignments (p = .013). No other effects were statistically significant. Because these are exploratory tests and would not survive multiple comparison correction, we do not offer further consideration of these effects.
